## 一、执行顺序

* FROM
* JOIN
* ON
* WHERE
* GROUP BY(此处开始可以使用select中的别名)
* AVG/SUM
* HAVING
* SELECT
* DISTINCT
* ORDER BY 
* LIMIT



## 二、执行计划

* 语句：explain select * from user;

* 输出

  | 列            | 说明                                                |
  | ------------- | --------------------------------------------------- |
  | id            | ID越大，越先执行，相同的从上到下执行                |
  | select_type   | system > const > eq_ref > ref > range > index > ALL |
  | table         | 输出记录的表                                        |
  | partitions    | 匹配的分区                                          |
  | type          | JOIN 的类型                                         |
  | possible_keys | 优化器可能选择的索引                                |
  | key           | 优化器实际选择的索引                                |
  | key_len       | 使用索引的字节长度                                  |
  | ref           | 进行比较的索引列                                    |
  | rows          | 优化器预估的记录数量                                |
  | filtered      | 根据条件过滤得到的记录的百分比                      |
  | extra         | 额外的显示选项                                      |



## 三、索引

* 定义：加速对表中数据行的检索而创建的一种分散存储的数据结构
* 好处：极大地减少存储引擎需要扫描的数据量、随机IO变成顺序IO、分组排序等操作时避免使用临时表
* 结构：B+树
* 分类
  * 聚集索引：key为主键，叶子节点存放了完整的数据行，InnoDB必有且只有1个
  * 二级索引：叶子节点存放主键，查询非索引字段需要再查一次聚集索引，即回表



## 四、表设计

* 三范式
  * 字段具有原子性，不可分割
  * 行具有唯一性，非主键字段完全依赖于主键
  * 非主键字段直接依赖于主键，不存在传递依赖

* 字段
  * 尽量选择小的数据类型和指定短的长度
  * 字段不宜过多
  * 尽量使用not null



## 附一 字段类型

### 1. 数字

| 类型        | 空间  | 范围               | UNSIGNED范围   |
| ----------- | ----- | :----------------- | -------------- |
| TINYINT     | 1字节 | [-128, 127]        | [0, 255]       |
| SMALLINT    | 2字节 | [-2^15,  2^15 -1 ] | [0,  2^16 - 1] |
| MEDIUMINT   | 3字节 | [-2^23,  2^23 -1 ] | [0, 2^24 - 1]  |
| INT/INTEGER | 4字节 | [-2^31,  2^31 -1 ] | [0, 2^32 - 1]  |
| BIGINT      | 8字节 | [-2^63,  2^63 -1 ] | [0, 2^64 - 1]  |
| FLOAT       | 4字节 |                    |                |
| DOUBLE      | 8字节 |                    |                |
| DECIMAL     |       |                    |                |

### 2.字符串

| 类型         | 最大长度 | 说明                                 |
| ------------ | -------- | ------------------------------------ |
| CHAR(N)      | 255      | 定长字符，字符不够时尾部使用空格填充 |
| VARCHAR(N)   | 16384    | 变长字符                             |
| BINARY(N)    | 255      | 定长二进制字节                       |
| VARBINARY(N) | 16384    | 变长二进制字节                       |
| TINYBLOB     | 256      | 二进制大对象                         |
| BLOB         | 16K      | 二进制大对象                         |
| MEDIUMBLOB   | 16M      | 二进制大对象                         |
| LONGBLOB     | 4G       | 二进制大对象                         |
| TINYTEXT     | 256      | 大对象                               |
| TEXT         | 16K      | 大对象                               |
| MEDIUMTEXT   | 16M      | 大对象                               |
| LONGTEXT     | 4G       | 大对象                               |

### 3. 日期

| 类型      | 空间   | 范围                                              |
| --------- | ------ | ------------------------------------------------- |
| DATE      | 3字节  | 1000-01-01 ~ 9999-12-31                           |
| TIME      | 3字节  | -838:59:59 ~ 838:59:59                            |
| YEAR      | 1字节  | 1901 ~ 2155                                       |
| DATETIME  | 8字节  | 1000-01-01 00:00:00 ~ 9999-12-31 23:59:59         |
| TIMESTAMP | 4 字节 | 1970-01-01 00:00:00 UTC ~ 2038-01-19 03:14:07 UTC |



* 